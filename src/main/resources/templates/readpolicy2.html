<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<meta http-equiv="Cache-Control" content="no-store" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<title>ì •ì±… ì¡°íšŒ</title>
<meta name="description" content="">

<!-- Favicon -->
<link rel="icon" type="image/x-icon"
	href="/img/img_sneat/favicon/favicon.ico">

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link
	href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&amp;display=swap"
	rel="stylesheet">
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
	rel="stylesheet">

<!-- Icons. Uncomment required icon fonts -->
<link rel="stylesheet" href="/vendor/vendor_sneat/fonts/boxicons.css">

<!-- Core CSS -->
<link rel="stylesheet" href="/vendor/vendor_sneat/css/core.css"
	class="template-customizer-core-css">
<link rel="stylesheet" href="/vendor/vendor_sneat/css/theme-default.css"
	class="template-customizer-theme-css">
<link rel="stylesheet" href="/css/css_sneat/demo.css">

<!-- Vendors CSS -->
<link rel="stylesheet"
	href="/vendor/vendor_sneat/libs/perfect-scrollbar/perfect-scrollbar.css">

<!-- Page CSS -->
<!-- Helpers -->
<script src="/vendor/vendor_sneat/js/helpers.js"></script>

<style type="text/css">
.layout-menu-fixed .layout-navbar-full .layout-menu, .layout-page {
	padding-top: 0px !important;
}

.content-wrapper {
	padding-bottom: 0px !important;
}
</style>

<!--! Template customizer & Theme config files MUST be included 
	after core stylesheets and helpers.js in the <head> section -->
<!--? Config:  Mandatory theme config file contain global vars & default theme options, 
	Set your preferred theme option in this file.  -->
<script src="/js/js_sneat/config.js"></script>

<!-- ë‚´ css ìŠ¤íƒ€ì¼ -->
<link rel="stylesheet" href="/css/custom.css">

</head>
<body>
	<!-- Layout wrapper -->
	<div class="layout-wrapper layout-content-navbar">
		<div class="layout-container">

			<!-- Menu -->
			<aside id="layout-menu"
				class="layout-menu menu-vertical menu bg-menu-theme"
				data-bg-class="bg-menu-theme">
				<div class="app-brand demo">
					<a href="index.html" class="app-brand-link"> <span
						class="app-brand-logo demo"> <img src="/img/dbee.png"
							alt="DBee Logo" style="max-height: 40px;">
					</span> <!-- <span class="app-brand-text demo menu-text fw-bolder ms-2">DBee Manager</span> -->
						<span class="app-brand-text my-brand-text ms-2">DBee
							Manager</span>
					</a> <a href="javascript:void(0);"
						class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
						<i class="bx bx-chevron-left bx-sm align-middle"></i>
					</a>
				</div>

				<div class="menu-inner-shadow" style="display: block;"></div>
				<ul class="menu-inner py-1 ps ps--active-y">


					<!-- HOME -->
					<li class="menu-item"><a href="/dashboard2" class="menu-link">
							<i class="menu-icon tf-icons bx bx-home-circle"></i>
							<div data-i18n="Analytics">HOME</div>
					</a></li>

					<li class="menu-header small text-uppercase"><span
						class="menu-header-text">menu</span></li>

					<li class="menu-item"><a href="/dashboard2" class="menu-link">
							<i class="menu-icon tf-icons bx bx-bar-chart"></i>
							<div data-i18n="Dashboard">Dashboard</div>
					</a></li>

					<li class="menu-item">
						<!-- ì •ì±…ê´€ë¦¬ ë©”ë‰´ -->
						<div class="d-flex align-items-center justify-content-between">
							<!-- ë©”ë‰´ í…ìŠ¤íŠ¸ (ì´ë™) -->
							<a href="/readpolicy2" class="menu-link text-decoration-none"
								id="policy-menu-text"> <i
								class="menu-icon tf-icons bx bx-shield"></i> <span>ì •ì±… ê´€ë¦¬</span>
							</a>

							<!-- â–¼ í† ê¸€ ë²„íŠ¼ -->
							<button class="btn btn-sm p-0 border-0 bg-transparent"
								id="policy-toggle-button">
								<i class="bx bx-chevron-down"></i>
							</button>
						</div> <!-- í•˜ìœ„ ë©”ë‰´ -->
						<ul class="menu-sub" id="policy-submenu" style="display: none;">
							<li class="menu-item"><a href="/readpolicy2"
								class="menu-link">ì •ì±… ì¡°íšŒ</a></li>
							<li class="menu-item"><a href="/registerpolicy"
								class="menu-link">ì •ì±… ë“±ë¡</a></li>
							<li class="menu-item"><a href="/writepolicy"
								class="menu-link">ì •ì±… ìˆ˜ì •</a></li>
						</ul>
					</li>
					<li class="menu-item">
					<a
						href="/logs"
						target="_blank" class="menu-link">
                		<i class="menu-icon tf-icons bx bx-file"></i>
                		<div data-i18n="Documentation">ë¡œê·¸ ê´€ë¦¬</div>
              		</a>
            		</li>
					
					

				</ul>
				<div class="ps__rail-x" style="left: 0px; bottom: -14px;">
					<div class="ps__thumb-x" tabindex="0"
						style="left: 0px; width: 0px;"></div>
				</div>
				<div class="ps__rail-y"
					style="top: 14px; height: 877px; right: 4px;">
					<div class="ps__thumb-y" tabindex="0"
						style="top: 14px; height: 863px;"></div>
				</div>
			</aside>
			<!-- / Menu -->

			<!-- Layout container -->
			<div class="layout-page">

				<!-- Navbar -->
				<!-- <nav
					class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
					id="layout-navbar"> -->
				<div
					class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
					<a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
						<i class="bx bx-menu bx-sm"></i>
					</a>
				</div>

				<!-- <div class="navbar-nav-right d-flex align-items-center"
						id="navbar-collapse"> -->

				<!-- Search -->
				<!-- 						<div class="navbar-nav align-items-center">
							<div class="nav-item d-flex align-items-center">
								<i class="bx bx-search fs-4 lh-0"></i> <input type="text"
									class="form-control border-0 shadow-none"
									placeholder="Search..." aria-label="Search...">
							</div>
						</div> -->
				<!-- /Search -->

				<ul class="navbar-nav flex-row align-items-center ms-auto">
					<!-- Place this tag where you want the button to render. -->
					<li class="nav-item lh-1 me-3"><span></span></li>

					<!-- User -->
					<li class="nav-item navbar-dropdown dropdown-user dropdown">
						<!-- ë²„íŠ¼ ì—­í• : í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ ì—´ë¦¼ --> <a
						class="nav-link dropdown-toggle hide-arrow"
						href="javascript:void(0);" data-bs-toggle="dropdown"> <!-- ìœ ì € ì•„ë°”íƒ€ -->
							<div class="avatar avatar-online">
								<img src="../assets/img/avatars/1.png" alt=""
									class="w-px-40 h-auto rounded-circle">
							</div>
					</a> <!-- ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ë³¸ì²´ -->
						<ul class="dropdown-menu dropdown-menu-end">
							<!-- ìœ ì € ì •ë³´ ìš”ì•½ -->
							<li><a class="dropdown-item" href="#">
									<div class="d-flex">
										<div class="flex-shrink-0 me-3">
											<div class="avatar avatar-online">
												<img src="../assets/img/avatars/1.png" alt=""
													class="w-px-40 h-auto rounded-circle">
											</div>
										</div>
										<div class="flex-grow-1">
											<span class="fw-semibold d-block">John Doe</span> <small
												class="text-muted">Admin</small>
										</div>
									</div>
							</a></li>
							<!-- êµ¬ë¶„ì„  -->
							<li>
								<div class="dropdown-divider"></div>
							</li>
							<li><a class="dropdown-item" href="#"> <i
									class="bx bx-user me-2"></i> <span class="align-middle">My
										Profile</span>
							</a></li>

							<li><a class="dropdown-item" href="#"> <i
									class="bx bx-cog me-2"></i> <span class="align-middle">Settings</span>
							</a></li>

							<li><a class="dropdown-item" href="#"> <span
									class="d-flex align-items-center align-middle"> <i
										class="flex-shrink-0 bx bx-credit-card me-2"></i> <span
										class="flex-grow-1 align-middle">Billing</span> <span
										class="flex-shrink-0 badge badge-center rounded-pill bg-danger w-px-20 h-px-20">
											4 </span>
								</span>
							</a></li>

							<li>
								<div class="dropdown-divider"></div>
							</li>

							<li><a class="dropdown-item" href="auth-login-basic.html">
									<i class="bx bx-power-off me-2"></i> <span class="align-middle">Log
										Out</span>
							</a></li>
						</ul>
					</li>
					<!--/ User -->
				</ul>
				<!-- </div> -->
				<!-- </nav> -->
				<!-- / Navbar -->

				<!-- Content wrapper -->
				<div class="content-wrapper">

					<!-- Content -->
					<div class="container-xxl flex-grow-1 container-p-y">
						<h4 class="fw-bold py-3 mb-4">
							<span class="text-muted fw-light"></span>ì •ì±… ì¡°íšŒ
						</h4>

						<!-- ê²€ìƒ‰ í•„í„° ì¹´ë“œ -->
						<div class="card mb-4">
							<h5
								class="card-header d-flex justify-content-between align-items-center">
								ì •ì±… ì¡°ê±´ ê²€ìƒ‰
								<button class="btn btn-sm btn-outline-primary" type="button"
									data-bs-toggle="collapse" data-bs-target="#policySearchForm"
									aria-expanded="false" aria-controls="policySearchForm">
									ğŸ” ì—´ê¸°/ë‹«ê¸°</button>
							</h5>
							<div class="collapse" id="policySearchForm">
								<div class="card-body">
									<form id="searchForm">
										<div class="row g-3">
											<!-- ì˜ˆ: ì •ì±… ID -->
											<div class="col-md-2">
												<label class="form-label">ì •ì±… ID</label> <input type="text"
													class="form-control" name="p_id" />
											</div>
											<div class="col-md-2">
												<label class="form-label">ì •ì±… ì´ë¦„</label> <input type="text"
													class="form-control" name="name" />
											</div>
											<div class="col-md-2">
												<label class="form-label">ìƒíƒœ</label> <select
													class="form-select" name="status">
													<option value="">--ì „ì²´--</option>
													<option value="ACTIVE">ACTIVE</option>
													<option value="INACTIVE">INACTIVE</option>
												</select>
											</div>
											<!-- ë‚˜ë¨¸ì§€ í•„í„°ë“¤ë„ ì´ëŸ° ì‹ìœ¼ë¡œ col-md-2ë‚˜ col-md-3ì— ë°°ì¹˜ -->
											<!-- ì •ì±… íƒ€ì… -->
											<div class="col-md-2">
												<label class="form-label">ì •ì±… íƒ€ì…</label> <select
													name="policy_type" class="form-select">
													<option value="">--ì „ì²´--</option>
													<option value="PATTERN">PATTERN</option>
													<option value="BEHAVIOR">BEHAVIOR</option>
												</select>
											</div>

											<!-- ì¡°ì¹˜ í•„í„° í† ê¸€ -->
											<div class="col-auto position-relative">
												<button type="button" class="filter-toggle-button"
													id="toggleAction">ğŸ”§ ì¡°ì¹˜</button>
												<div class="filter-toggle-box" id="actionBox">
													<label class="form-check form-check-inline"> <input
														class="form-check-input" type="checkbox"
														name="action_to_take_list" value="LOG" /> LOG
													</label> <label class="form-check form-check-inline"> <input
														class="form-check-input" type="checkbox"
														name="action_to_take_list" value="ALERT" /> ALERT
													</label> <label class="form-check form-check-inline"> <input
														class="form-check-input" type="checkbox"
														name="action_to_take_list" value="BLOCK" /> BLOCK
													</label>
												</div>
											</div>

											<!-- ìœ„í˜‘ í•„í„° í† ê¸€ -->
											<div class="col-auto position-relative">
												<button type="button" class="filter-toggle-button"
													id="toggleThreat">âš ï¸ ìœ„í˜‘</button>
												<div class="filter-toggle-box" id="threatBox">
													<label class="form-check form-check-inline"> <input
														class="form-check-input" type="checkbox"
														name="threat_levels" value="LOW" /> LOW
													</label> <label class="form-check form-check-inline"> <input
														class="form-check-input" type="checkbox"
														name="threat_levels" value="MEDIUM" /> MEDIUM
													</label> <label class="form-check form-check-inline"> <input
														class="form-check-input" type="checkbox"
														name="threat_levels" value="HIGH" /> HIGH
													</label> <label class="form-check form-check-inline"> <input
														class="form-check-input" type="checkbox"
														name="threat_levels" value="CRITICAL" /> CRITICAL
													</label>
												</div>
											</div>


											<!-- âœ… base_sec & base_count í•„í„° ì¤„ -->
											<div class="row mt-2 g-2">
												<div class="col-auto">
													<label class="form-label">ìµœì†Œ base_sec</label> <input
														type="number" name="min_base_sec"
														class="form-control form-control-sm w-auto" />
												</div>
												<div class="col-auto">
													<label class="form-label">ìµœëŒ€ base_sec</label> <input
														type="number" name="max_base_sec"
														class="form-control form-control-sm w-auto" />
												</div>
												<div class="col-auto">
													<label class="form-label">ìµœì†Œ base_count</label> <input
														type="number" name="min_base_count"
														class="form-control form-control-sm w-auto" />
												</div>
												<div class="col-auto">
													<label class="form-label">ìµœëŒ€ base_count</label> <input
														type="number" name="max_base_count"
														class="form-control form-control-sm w-auto" />
												</div>

												<div class="col-auto">
													<label class="form-label">ìµœì†Œ ì°¨ë‹¨ ì‹œê°„</label> <input
														type="number" name="min_block_duration"
														class="form-control form-control-sm w-auto" />
												</div>
												<div class="col-auto">
													<label class="form-label">ìµœëŒ€ ì°¨ë‹¨ ì‹œê°„</label> <input
														type="number" name="max_block_duration"
														class="form-control form-control-sm w-auto" />
												</div>
											</div>
										</div>


										<!-- ê²€ìƒ‰ ë²„íŠ¼ -->
										<div class="d-flex justify-content-end mt-3">
											<button type="submit" class="btn btn-sm btn-primary">ê²€ìƒ‰</button>
										</div>
								</div>
							</div>
						</div>

						<!-- Bordered Table -->
						<div class="card">
							<h5 class="card-header">ì •ì±… ëª©ë¡</h5>
							<div class="card-body">
								<div class="table-responsive text-nowrap">
									<table class="table table-bordered">
										<thead>
											<tr>
												<th>ì •ì±… ID</th>
												<th>ì´ë¦„</th>
												<th>ìƒíƒœ</th>
												<th>ì„¤ëª…</th>
												<th>ìƒì„±ì</th>
												<th>ìˆ˜ì •ì</th>
												<th>base_sec</th>
												<th>base_count</th>
												<th>ì¶œë°œì§€ IP ì‹œì‘</th>
												<th>ì¶œë°œì§€ IP ë</th>
												<th>ëª©ì ì§€ IP ì‹œì‘</th>
												<th>ëª©ì ì§€ IP ë</th>
												<th>ëª©ì ì§€ í¬íŠ¸ ì‹œì‘</th>
												<th>ëª©ì ì§€ í¬íŠ¸ ë</th>
												<th>íŒ¨í„´ 1</th>
												<th>íŒ¨í„´ 2</th>
												<th>íŒ¨í„´ 3</th>
												<th>ì •ì±… íƒ€ì…</th>
												<th>ìœ„í—˜ë„</th>
												<th>ì¡°ì¹˜</th>
												<th>ìƒì„±ì¼</th>
												<th>ìˆ˜ì •ì¼</th>
												<th>ì°¨ë‹¨ ì‹œê°„</th>
											</tr>
										</thead>
										<tbody id="policyTableBody">
											<!-- ì´ˆê¸° ì •ì±… ë°ì´í„° ë Œë”ë§ -->
											<tr th:each="policy : ${policies}">
												<td><strong th:text="${policy.p_id}"></strong></td>

												<td th:text="${policy.name}">
													<ul
														class="list-unstyled users-list m-0 avatar-group d-flex align-items-center">
														<li data-bs-toggle="tooltip" data-popup="tooltip-custom"
															data-bs-placement="top" class="avatar avatar-xs pull-up"
															title="" data-bs-original-title="Lilian Fuller"><img
															src="../assets/img/avatars/5.png" alt="Avatar"
															class="rounded-circle"></li>
														<li data-bs-toggle="tooltip" data-popup="tooltip-custom"
															data-bs-placement="top" class="avatar avatar-xs pull-up"
															title="" data-bs-original-title="Sophia Wilkerson">
															<img src="../assets/img/avatars/6.png" alt="Avatar"
															class="rounded-circle">
														</li>
														<li data-bs-toggle="tooltip" data-popup="tooltip-custom"
															data-bs-placement="top" class="avatar avatar-xs pull-up"
															title="" data-bs-original-title="Christina Parker">
															<img src="../assets/img/avatars/7.png" alt="Avatar"
															class="rounded-circle">
														</li>
													</ul>
												</td>

												<td th:text="${policy.status} ?: 'ì—†ìŒ'"><span
													class="badge bg-label-primary me-1"></span></td>
												<td th:text="${policy.description} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.created_by} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.updated_by} ?: 'ì—†ìŒ'"></td>
												<td
													th:text="${policy.base_sec != null ? policy.base_sec : 'ì—†ìŒ'}"></td>
												<td
													th:text="${policy.base_count != null ? policy.base_count : 'ì—†ìŒ'}"></td>
												<td th:text="${policy.src_ip_start} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.src_ip_end} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.dst_ip_start} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.dst_ip_end} ?: 'ì—†ìŒ'"></td>
												<td
													th:text="${policy.dst_port_start != null ? policy.dst_port_start : 'ì—†ìŒ'}"></td>
												<td
													th:text="${policy.dst_port_end != null ? policy.dst_port_end : 'ì—†ìŒ'}"></td>
												<td th:text="${policy.payload_content1} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.payload_content2} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.payload_content3} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.policy_type} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.threat_level} ?: 'ì—†ìŒ'"></td>
												<td th:text="${policy.action_to_take}"></td>
												<td
													th:text="${#dates.format(policy.created_at, 'yyyy-MM-dd HH:mm:ss')}"></td>
												<td
													th:text="${#dates.format(policy.updated_at, 'yyyy-MM-dd HH:mm:ss')}"></td>
												<td th:text="${policy.block_duration} ?: 'ì—†ìŒ'"></td>
											</tr>


											<tr>
												<td><i class="fab fa-react fa-lg text-info me-3"></i> <strong>React
														Project</strong></td>
												<td>Barry Hunter</td>
												<td>
													<ul
														class="list-unstyled users-list m-0 avatar-group d-flex align-items-center">
														<li data-bs-toggle="tooltip" data-popup="tooltip-custom"
															data-bs-placement="top" class="avatar avatar-xs pull-up"
															title="" data-bs-original-title="Lilian Fuller"><img
															src="../assets/img/avatars/5.png" alt="Avatar"
															class="rounded-circle"></li>
														<li data-bs-toggle="tooltip" data-popup="tooltip-custom"
															data-bs-placement="top" class="avatar avatar-xs pull-up"
															title="" data-bs-original-title="Sophia Wilkerson">
															<img src="../assets/img/avatars/6.png" alt="Avatar"
															class="rounded-circle">
														</li>
														<li data-bs-toggle="tooltip" data-popup="tooltip-custom"
															data-bs-placement="top" class="avatar avatar-xs pull-up"
															title="" data-bs-original-title="Christina Parker">
															<img src="../assets/img/avatars/7.png" alt="Avatar"
															class="rounded-circle">
													</ul>
												</td>
												<td><span class="badge bg-label-success me-1">Completed</span></td>
												<td>
													<div class="dropdown">
														<button type="button"
															class="btn p-0 dropdown-toggle hide-arrow"
															data-bs-toggle="dropdown">
															<i class="bx bx-dots-vertical-rounded"></i>
														</button>
														<div class="dropdown-menu">
															<a class="dropdown-item" href="javascript:void(0);"><i
																class="bx bx-edit-alt me-1"></i> Edit</a> <a
																class="dropdown-item" href="javascript:void(0);"><i
																class="bx bx-trash me-1"></i> Delete</a>
														</div>
													</div>
												</td>
											</tr>


										</tbody>
									</table>
								</div>
							</div>
						</div>
						<!--/ Bordered Table -->

						<hr class="my-5">


						<!-- / Layout page -->
					</div>
					<!-- Overlay -->
					<div class="layout-overlay layout-menu-toggle"></div>

				</div>
				<!-- / Layout wrapper -->

				<!-- Core JS -->
				<!-- build:js assets/vendor/js/core.js -->
				<script src="/vendor/vendor_sneat/libs/jquery/jquery.js"></script>
				<script src="/vendor/vendor_sneat/libs/popper/popper.js"></script>
				<script src="/vendor/vendor_sneat/js/bootstrap.js"></script>
				<script
					src="/vendor/vendor_sneat/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
				<script src="/vendor/vendor_sneat/js/menu.js"></script>
				<!-- endbuild -->
				<!-- Vendors JS -->
				<!-- Main JS -->
				<script src="/js/js_sneat/main.js"></script>
				<!-- Page JS -->
				<!-- Place this tag in your head or just before your close body tag. -->
				<script async="" defer="" src="https://buttons.github.io/buttons.js"></script>

				<script src="/js/readpolicy2.js"></script>
</body>
</html>